

name: Sample Should Fail All Runs
on: push
jobs:
  job:
    runs-on: self-hosted
    strategy:
      matrix:
        run: ['run1', 'run2', 'run3']
      max-parallel: 3
    steps:
      - run: echo Run ${{ matrix.run }}
      - run: date
      - name: Exit early if matrix run is run1
        run: '[ "${{ matrix.run }}" = "run1" ] && exit 1 || echo "continue"'
      - run: sleep 5 # Sleep to make sure all process that don't match above check don't finish before the one that will exit
      - run: date
